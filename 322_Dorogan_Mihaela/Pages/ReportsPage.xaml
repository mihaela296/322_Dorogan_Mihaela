<Page x:Class="_322_Dorogan_Mihaela.Pages.ReportsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Отчеты">

    <Grid Background="{StaticResource PrimaryBrush1}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryBrush2}" 
                BorderBrush="{StaticResource TextBrushBlack}" BorderThickness="0,0,0,1" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="ГЕНЕРАЦИЯ ОТЧЕТОВ" FontSize="16" FontWeight="Bold" 
                          VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="BtnBack" Content="Назад" Width="80" Height="30"
                            Click="BtnBack_Click" Margin="0,0,10,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Основной контент -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20" Orientation="Vertical">

                <!-- Отчет по пользователям -->
                <GroupBox Header="📊 Отчет по пользователям" Margin="0,0,0,15"
                         Background="{StaticResource SecondaryBrush2}">
                    <StackPanel Orientation="Vertical" Margin="10">
                        <TextBlock Text="Генерация детального отчета по платежам пользователей за выбранный период"
                                  TextWrapping="Wrap" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Label Content="Период:" FontWeight="Bold" VerticalAlignment="Center"/>
                            <DatePicker x:Name="DpUserReportStart" Width="120" Margin="5,0"/>
                            <Label Content="-" VerticalAlignment="Center"/>
                            <DatePicker x:Name="DpUserReportEnd" Width="120" Margin="5,0"/>

                            <Label Content="Пользователь:" FontWeight="Bold" VerticalAlignment="Center" Margin="20,0,5,0"/>
                            <ComboBox x:Name="CbUserReport" Width="200" DisplayMemberPath="FIO"
                                     ToolTip="Выберите пользователя (оставьте пустым для всех пользователей)"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="BtnGenerateUserReport" Content="📄 Создать отчет в Word" 
                                    Width="180" Height="35" Click="BtnGenerateUserReport_Click"
                                    FontWeight="Bold" Margin="0,0,10,0"/>
                            <Button x:Name="BtnExportUserExcel" Content="📊 Экспорт в Excel" 
                                    Width="140" Height="35" Click="BtnExportUserExcel_Click"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Отчет по категориям -->
                <GroupBox Header="📂 Отчет по категориям" Margin="0,0,0,15"
                         Background="{StaticResource SecondaryBrush2}">
                    <StackPanel Orientation="Vertical" Margin="10">
                        <TextBlock Text="Аналитический отчет по расходам по категориям"
                                  TextWrapping="Wrap" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Label Content="Период:" FontWeight="Bold" VerticalAlignment="Center"/>
                            <DatePicker x:Name="DpCategoryReportStart" Width="120" Margin="5,0"/>
                            <Label Content="-" VerticalAlignment="Center"/>
                            <DatePicker x:Name="DpCategoryReportEnd" Width="120" Margin="5,0"/>

                            <Label Content="Категория:" FontWeight="Bold" VerticalAlignment="Center" Margin="20,0,5,0"/>
                            <ComboBox x:Name="CbCategoryReport" Width="200" DisplayMemberPath="Name"
                                     ToolTip="Выберите категорию (оставьте пустым для всех категорий)"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="BtnGenerateCategoryReport" Content="📄 Создать отчет в Word" 
                                    Width="180" Height="35" Click="BtnGenerateCategoryReport_Click"
                                    FontWeight="Bold" Margin="0,0,10,0"/>
                            <Button x:Name="BtnExportCategoryExcel" Content="📊 Экспорт в Excel" 
                                    Width="140" Height="35" Click="BtnExportCategoryExcel_Click"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Сводный отчет -->
                <GroupBox Header="📈 Сводный отчет" Margin="0,0,0,15"
                         Background="{StaticResource SecondaryBrush2}">
                    <StackPanel Orientation="Vertical" Margin="10">
                        <TextBlock Text="Полный сводный отчет по всем платежам системы"
                                  TextWrapping="Wrap" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Label Content="Период:" FontWeight="Bold" VerticalAlignment="Center"/>
                            <DatePicker x:Name="DpSummaryReportStart" Width="120" Margin="5,0"/>
                            <Label Content="-" VerticalAlignment="Center"/>
                            <DatePicker x:Name="DpSummaryReportEnd" Width="120" Margin="5,0"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="BtnGenerateSummaryReport" Content="📄 Создать отчет в Word" 
                                    Width="180" Height="35" Click="BtnGenerateSummaryReport_Click"
                                    FontWeight="Bold" Margin="0,0,10,0"/>
                            <Button x:Name="BtnExportSummaryExcel" Content="📊 Экспорт в Excel" 
                                    Width="140" Height="35" Click="BtnExportSummaryExcel_Click"/>
                            <Button x:Name="BtnExportAllData" Content="💾 Экспорт всех данных" 
                                    Width="160" Height="35" Click="BtnExportAllData_Click"
                                    Margin="10,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Статистика системы -->
                <GroupBox Header="🔢 Статистика системы" 
                         Background="{StaticResource SecondaryBrush2}">
                    <StackPanel Orientation="Vertical" Margin="10">
                        <TextBlock Text="Общая статистика и метрики системы"
                                  TextWrapping="Wrap" Margin="0,0,0,10"/>

                        <Button x:Name="BtnGenerateSystemStats" Content="📊 Сгенерировать статистику" 
                                Width="200" Height="35" Click="BtnGenerateSystemStats_Click"
                                FontWeight="Bold" HorizontalAlignment="Left"/>

                        <!-- Статистика -->
                        <Border BorderBrush="LightGray" BorderThickness="1" Margin="0,10,0,0" 
                               Padding="10" Background="{StaticResource SecondaryBrush1}">
                            <StackPanel x:Name="SpStats" Orientation="Vertical">
                                <TextBlock x:Name="TbStats" TextWrapping="Wrap" FontSize="11"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>